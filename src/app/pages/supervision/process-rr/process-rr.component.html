<section class="container py-3">
  <app-breadcrumb></app-breadcrumb>

  <div class="container-module px-sm-2 px-md-5">
    <div class="row" *ngIf="stages">
      <div class="col-sm-4 col-md-3 py-3 step-vertical">
        <ng-container *ngFor="let stage of stages; let i = index">
          <div class="step-item" (click)="changeStage(stage)">
            <div class="step-item-icon step-item-icon-process"
              [ngClass]=" {
                'step-item-icon-process':stage.status == 1 && stage.stage == stageSelected,
                'step-item-icon-notcompleted':stage.status == 0,
                'step-item-icon-completed':stage.status == 1 && stage.stage != stageSelected
              }"
            >{{ i + 1 }}</div>
            <div class="step-item-content" [ngClass]="{'selected-item': stage.stage == stageSelected}">
              <label class="title">{{ stage.processName }}</label>
              <ng-container ng-switch="myVar">
                <ng-container [ngSwitch]="stage.status">
                  <label class="subtitle" *ngSwitchCase="1">Completado</label>
                  <label class="subtitle" *ngSwitchCase="0">No completado</label>
                </ng-container>
              </ng-container>

            </div>
            <ng-container *ngIf="i+1 !== stages.length">
              <div class="step-item-bar" [ngClass]=" {
                'bar-notcompleted':stage.status != 'completed',
                'bar-completed':stage.status == 'completed'
              }"></div>
            </ng-container>
          </div>
        </ng-container>
      </div>
      <div class="col-sm-8 col-md-9 text-center container-stages">
        <ng-container [ngSwitch]="stageSelected">

          <!-- STEP 1 -->
          <ng-container *ngSwitchCase="1">
            <div *ngIf="stages[stageSelected -1].status == 0" class="alert alert-secondary" role="alert">
              {{ processParams.msgsByStages[1].success }}
            </div>
            <div *ngIf="stages[stageSelected -1].status == 1" class="alert alert-success" role="alert">
              {{ processParams.msgsByStages[1].failed }}
            </div>
            <div class="row text-light text-center mt-4">
              <div class="col-sm container-buttons">
                <button type="button" (click)="openModal()" [disabled]="stages[stageSelected -1].status == 1" class="btn btn-primary btn-sm">
                  Ejecutar Reglas
                </button>
              </div>
            </div>
          </ng-container>
          <!-- STEP 2 -->
          <ng-container *ngSwitchCase="2">
            <div *ngIf="stages[stageSelected - 2].status == 0" class="alert alert-secondary" role="alert">
              {{ processParams.msgsByStages[2].disabled }}
            </div>
            <div *ngIf="stages[stageSelected -2].status == 1 && stages[stageSelected - 1].status == 0" class="alert alert-secondary" role="alert">
              {{ processParams.msgsByStages[2].failed }}
            </div>
            <div *ngIf="stages[stageSelected - 1].status == 1" class="alert alert-success" role="alert">
              {{ processParams.msgsByStages[2].success }}
            </div>
            <div class="row text-light text-center mt-4">
              <div class="col-sm container-buttons">
                <button type="button" (click)="openModal()" [disabled]="stages[stageSelected -2].status == 0 || stages[stageSelected -1].status == 1" class="btn btn-primary btn-sm">
                  Validar Nodos
                </button>
              </div>
            </div>
          </ng-container>
          <!-- STEP 3 -->
          <ng-container *ngSwitchCase="3">
            <div *ngIf="stages[stageSelected - 2].status == 0" class="alert alert-secondary" role="alert">
              ¡Esta opcíon se encuentra inhabilitada, debe haber confirmado la Validación de Nodos para poder continuar!
            </div>
            <div *ngIf="stages[stageSelected -2].status == 1 && stages[stageSelected - 1].status == 0" class="alert alert-secondary" role="alert">
              ¡Aún no ha ejecutado las Reglas de Negocio RR!
            </div>
            <div *ngIf="stages[stageSelected - 1].status == 1" class="alert alert-success" role="alert">
              ¡El proceso ejecución de Reglas de Negocio RR ha sido completado, se generará los Nodos y Cuentas!
            </div>
            <div class="row text-light text-center mt-4">
              <div class="col-sm container-buttons">
                <button type="button" (click)="openModal()" [disabled]="stages[stageSelected -2].status == 0 || stages[stageSelected -1].status == 1" class="btn btn-primary btn-sm">
                  Ejecutar Reglas Negocio RR
                </button>
              </div>
            </div>
          </ng-container>
          <!-- STEP 4 -->
          <!-- <ng-container *ngSwitchCase="4">
            <div *ngIf="stages[stageSelected - 2].status == 0" class="alert alert-secondary" role="alert">
              ¡Esta opcíon se encuentra inhabilitada, debe haber ejecutado las Reglas de Negocio para poder continuar!
            </div>
            <div *ngIf="stages[stageSelected - 1].status == 1" class="alert alert-success" role="alert">
              ¡El proceso generación de Nodos y Cuentas ha sido completado, puede proceder al cargue de información!
            </div>
          </ng-container> -->
          <!-- STEP 5 -->
          <!-- <ng-container *ngSwitchCase="5">
            <div *ngIf="stages[stageSelected - 2].status == 0" class="alert alert-secondary" role="alert">
              ¡Esta opcíon se encuentra inhabilitada, debe haber generado los Nodos y Cuentas para poder continuar!
            </div>
            <div *ngIf="stages[stageSelected -2].status == 1 && stages[stageSelected - 1].status == 0" class="alert alert-secondary" role="alert">
              ¡Aún no ha confirmado la carga de información de Rentas!
            </div>
            <div *ngIf="stages[stageSelected - 1].status == 1" class="alert alert-success" role="alert">
              ¡El proceso confirmación de carga de información de Rentas ha sido completado, se generará los archivos de Facturación!
            </div>
            <div class="row text-light text-center mt-4">
              <div class="col-sm container-buttons">
                <button type="button" (click)="openModal()" [disabled]="stages[stageSelected -2].status == 0 || stages[stageSelected -1].status == 1" class="btn btn-primary btn-sm">
                  Confirmar Información Rentas
                </button>
              </div>
            </div>
          </ng-container> -->
          <!-- STEP 6 -->
          <!-- <ng-container *ngSwitchCase="6">
            <div *ngIf="stages[stageSelected - 2].status == 0" class="alert alert-secondary" role="alert">
              ¡Esta opcíon se encuentra inhabilitada, debe haber cargado la información de Rentas para poder continuar!
            </div>
            <div *ngIf="stages[stageSelected - 1].status == 1" class="alert alert-success" role="alert">
              ¡El proceso generación Archivos de Facturación ha sido completado!
            </div>
          </ng-container> -->
        </ng-container>
      </div>
    </div>




    <!-- Sino hay procesos en BD -->
    <div class="row" *ngIf="!stages">
      <div class="col-md py-3">
        <div class="alert alert-secondary" role="alert">
          {{ processParams.empty }}
        </div>
      </div>
    </div>
  </div>

  <hr class="mt-5 mb-5" />
</section>

<p-confirmDialog [key]="randomKey" rejectLabel="Cancelar" acceptLabel="Aceptar">
</p-confirmDialog>
